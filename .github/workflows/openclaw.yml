name: OpenClaw Bot

on:
  issues:
    types: [opened, edited]
  issue_comment:
    types: [created]
  pull_request:
    types: [opened, synchronize, reopened]
  pull_request_review_comment:
    types: [created]
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:
    inputs:
      message:
        description: 'Custom message to send to the agent'
        required: false
        default: 'Manual trigger - review the repo'

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  openclaw-bot:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '22'
      - uses: offloadmywork/openclaw-github-app@main
        with:
          api_key: ${{ secrets.OPENROUTER_API_KEY }}
          provider: 'openrouter'
          model: 'z-ai/glm-4.5-air:free'
          github_token: ${{ secrets.GITHUB_TOKEN }}
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
